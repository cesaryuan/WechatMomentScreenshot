{"version":3,"sources":["webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/util.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/clonePseudoElements.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/cloneNode.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/getBlobFromURL.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/embedResources.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/embedImages.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/embedWebFonts.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/createSvgDataURL.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/index.js","webpack://wechatmomentscreenshot/./main.js","webpack://wechatmomentscreenshot/./node_modules/html-to-image/es/applyStyleWithOptions.js"],"names":["WOFF","JPEG","mimes","woff","woff2","ttf","eot","png","jpg","jpeg","gif","tiff","svg","uuid","counter","Math","random","pow","toString","slice","getMimeType","url","ext","match","exec","getExtension","toLowerCase","isDataUrl","search","toDataURL","content","mimeType","getDataURLContent","dataURL","split","canvasToBlob","canvas","toBlob","Promise","resolve","binaryString","window","atob","len","length","binaryArray","Uint8Array","i","charCodeAt","Blob","type","toArray","arrayLike","result","l","push","px","node","styleProperty","val","getComputedStyle","getPropertyValue","parseFloat","replace","createImage","reject","image","Image","onload","onerror","crossOrigin","src","Pseudo","clonePseudoElement","nativeNode","clonedNode","pseudo","style","className","err","styleElement","document","createElement","appendChild","selector","cssText","formatCssText","map","name","getPropertyPriority","join","formatCssProperties","createTextNode","getPseudoElementStyle","thisArg","_arguments","P","generator","fulfilled","value","step","next","e","rejected","done","then","apply","cloneSingleNode","this","HTMLCanvasElement","cloneNode","filter","isRoot","children","childNodes","reduce","child","clonedChild","cloneChildren","Element","source","target","forEach","setProperty","cloneCssStyle","clonePseudoElements","HTMLTextAreaElement","innerHTML","HTMLInputElement","setAttribute","cloneInputValue","decorate","cache","getBlobFromURL","options","href","test","cacheBust","Date","getTime","promise","fetch","response","blob","reader","FileReader","onloadend","readAsDataURL","catch","req","XMLHttpRequest","onreadystatechange","readyState","status","Error","encoder","ontimeout","responseType","timeout","open","send","reason","placeholder","imagePlaceholder","parts","msg","message","console","error","URL_REGEX","shouldEmbed","string","embedResources","cssString","baseUrl","parseURLs","urls","ret","resourceURL","baseURL","get","resolvedURL","location","protocol","doc","implementation","createHTMLDocument","base","a","head","body","resolveUrl","data","RegExp","urlToRegex","str","raw","quotation","embedImages","background","embedBackground","HTMLImageElement","embedImageNode","deferreds","all","embedChildren","cssFetchPromiseStore","getCssRules","styleSheets","promises","sheet","cssRules","item","CSSRule","IMPORT_RULE","fetchCSS","embedFonts","parseCSS","rule","insertRule","log","inline","find","getWebFontRules","FONT_FACE_RULE","undefined","css","cssCommentsRegex","keyframesRegex","arr","unified","res","text","resolved","regexUrlFind","fontLoadedPromises","startsWith","URL","addEventListener","createSvgDataURL","width","height","xmlns","createElementNS","foreignObject","setAttributeNS","XMLSerializer","serializeToString","encodeURIComponent","html","svgToDataURL","el","getImageSize","domNode","leftBorder","rightBorder","scrollWidth","getNodeWidth","topBorder","bottomBorder","scrollHeight","getNodeHeight","toSvg","ownerDocument","parseWebFontRules","rules","parentStyleSheet","cssStrings","styleNode","sytleContent","firstChild","insertBefore","embedWebFonts","backgroundColor","manual","Object","keys","key","applyStyleWithOptions","toCanvas","args","setTimeout","context","getContext","ratio","pixelRatio","FINAL_PROCESS","process","env","devicePixelRatio","parseInt","isNaN","getPixelRatio","fillStyle","fillRect","drawImage","xhrGet","callback","xhr","responseText","toJpeg","quality","toPng","toPixelData","getImageData","avatarURL","JSON","parse","emoticon","config","avatarFile","configDefault","app","uiWhite","appIcon","statusIcon","localStorage","getItem","k","getTimeString","currentDate","specificDate","cd","getTimezoneOffset","sd","getHours","getMinutes","getFullYear","getMonth","getDate","getElementById","checked","backgroundImage","commentList","emoticonReplace","onclick","display","date","valueAsDate","floor","readyFake","files","createObjectURL","querySelectorAll","transform","useWhiteUI","classList","add","querySelector","remove","innerText","multiImageCount","iconWifi","iconBattery","iconApp","sort","configPostDate","setHours","setMinutes","configScreenshotDate","getElementsByClassName","avatarSource","concat","avatarUsedIndex","div","splice","avatar","Number","offset","bottom","fakeWechatMoment","dURL","mdui","Dialog","setItem","stringify","alert","finally","removeAttribute"],"mappings":"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","file":"bundle.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nconst WOFF = 'application/font-woff';\nconst JPEG = 'image/jpeg';\nconst mimes = {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml',\n};\nexport const uuid = (function uuid() {\n    // generate uuid for className of pseudo elements.\n    // We should not use GUIDs, otherwise pseudo elements sometimes cannot be captured.\n    let counter = 0;\n    // ref: http://stackoverflow.com/a/6248722/2519373\n    const random = () => `0000${((Math.random() * Math.pow(36, 4)) << 0).toString(36)}`.slice(-4);\n    return () => {\n        counter += 1;\n        return `u${random()}${counter}`;\n    };\n})();\nexport function getExtension(url) {\n    const match = /\\.([^./]*?)$/g.exec(url);\n    return match ? match[1] : '';\n}\nexport function getMimeType(url) {\n    const ext = getExtension(url).toLowerCase();\n    return mimes[ext] || '';\n}\nexport function delay(ms) {\n    return (args) => new Promise((resolve) => {\n        setTimeout(() => {\n            resolve(args);\n        }, ms);\n    });\n}\nexport function isDataUrl(url) {\n    return url.search(/^(data:)/) !== -1;\n}\nexport function toDataURL(content, mimeType) {\n    return `data:${mimeType};base64,${content}`;\n}\nexport function getDataURLContent(dataURL) {\n    return dataURL.split(/,/)[1];\n}\nfunction toBlob(canvas) {\n    return new Promise((resolve) => {\n        const binaryString = window.atob(canvas.toDataURL().split(',')[1]);\n        const len = binaryString.length;\n        const binaryArray = new Uint8Array(len);\n        for (let i = 0; i < len; i += 1) {\n            binaryArray[i] = binaryString.charCodeAt(i);\n        }\n        resolve(new Blob([binaryArray], { type: 'image/png' }));\n    });\n}\nexport function canvasToBlob(canvas) {\n    if (canvas.toBlob) {\n        return new Promise((resolve) => canvas.toBlob(resolve));\n    }\n    return toBlob(canvas);\n}\nexport function toArray(arrayLike) {\n    const result = [];\n    for (let i = 0, l = arrayLike.length; i < l; i += 1) {\n        result.push(arrayLike[i]);\n    }\n    return result;\n}\nfunction px(node, styleProperty) {\n    const val = window.getComputedStyle(node).getPropertyValue(styleProperty);\n    return parseFloat(val.replace('px', ''));\n}\nexport function getNodeWidth(node) {\n    const leftBorder = px(node, 'border-left-width');\n    const rightBorder = px(node, 'border-right-width');\n    return node.scrollWidth + leftBorder + rightBorder;\n}\nexport function getNodeHeight(node) {\n    const topBorder = px(node, 'border-top-width');\n    const bottomBorder = px(node, 'border-bottom-width');\n    return node.scrollHeight + topBorder + bottomBorder;\n}\nexport function getPixelRatio() {\n    let ratio;\n    let FINAL_PROCESS;\n    try {\n        FINAL_PROCESS = process;\n    }\n    catch (e) { }\n    const val = FINAL_PROCESS && FINAL_PROCESS.env\n        ? FINAL_PROCESS.env.devicePixelRatio\n        : null;\n    if (val) {\n        ratio = parseInt(val, 10);\n        if (isNaN(ratio)) {\n            ratio = 1;\n        }\n    }\n    return ratio || window.devicePixelRatio || 1;\n}\nexport function createImage(url) {\n    return new Promise((resolve, reject) => {\n        const image = new Image();\n        image.onload = () => resolve(image);\n        image.onerror = reject;\n        image.crossOrigin = 'anonymous';\n        image.src = url;\n    });\n}\nexport function svgToDataURL(svg) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return Promise.resolve()\n            .then(() => new XMLSerializer().serializeToString(svg))\n            .then(encodeURIComponent)\n            .then((html) => `data:image/svg+xml;charset=utf-8,${html}`);\n    });\n}\nexport function getBlobFromImageURL(url) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return createImage(url).then((image) => {\n            const { width, height } = image;\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n            const ratio = getPixelRatio();\n            canvas.width = width * ratio;\n            canvas.height = height * ratio;\n            canvas.style.width = `${width}`;\n            canvas.style.height = `${height}`;\n            context.scale(ratio, ratio);\n            context.drawImage(image, 0, 0);\n            const dataURL = canvas.toDataURL(getMimeType(url));\n            return getDataURLContent(dataURL);\n        });\n    });\n}\n//# sourceMappingURL=util.js.map","import { uuid, toArray } from './util';\nexport function clonePseudoElements(nativeNode, clonedNode) {\n    const pseudos = [':before', ':after'];\n    pseudos.forEach((pseudo) => Pseudo.clonePseudoElement(nativeNode, clonedNode, pseudo));\n}\nvar Pseudo;\n(function (Pseudo) {\n    function clonePseudoElement(nativeNode, clonedNode, pseudo) {\n        const style = window.getComputedStyle(nativeNode, pseudo);\n        const content = style.getPropertyValue('content');\n        if (content === '' || content === 'none') {\n            return;\n        }\n        const className = uuid();\n        // fix: Cannot assign to read only property 'className' of object '#<…\n        try {\n            clonedNode.className = `${clonedNode.className} ${className}`;\n        }\n        catch (err) {\n            return;\n        }\n        const styleElement = document.createElement('style');\n        styleElement.appendChild(getPseudoElementStyle(className, pseudo, style));\n        clonedNode.appendChild(styleElement);\n    }\n    Pseudo.clonePseudoElement = clonePseudoElement;\n    function getPseudoElementStyle(className, pseudo, style) {\n        const selector = `.${className}:${pseudo}`;\n        const cssText = style.cssText\n            ? formatCssText(style)\n            : formatCssProperties(style);\n        return document.createTextNode(`${selector}{${cssText}}`);\n    }\n    function formatCssText(style) {\n        const content = style.getPropertyValue('content');\n        return `${style.cssText} content: ${content};`;\n    }\n    function formatCssProperties(style) {\n        return toArray(style)\n            .map((name) => {\n            const value = style.getPropertyValue(name);\n            const priority = style.getPropertyPriority(name);\n            return `${name}: ${value}${priority ? ' !important' : ''};`;\n        })\n            .join(' ');\n    }\n})(Pseudo || (Pseudo = {}));\n//# sourceMappingURL=clonePseudoElements.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { clonePseudoElements } from './clonePseudoElements';\nimport { createImage, toArray } from './util';\nfunction cloneSingleNode(node) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (node instanceof HTMLCanvasElement) {\n            const dataURL = node.toDataURL();\n            if (dataURL === 'data:,') {\n                return Promise.resolve(node.cloneNode(false));\n            }\n            return createImage(dataURL);\n        }\n        // if (node.tagName && node.tagName.toLowerCase() === 'svg') {\n        //   return Promise.resolve(node as SVGElement)\n        //     .then((svg) => svgToDataURL(svg))\n        //     .then(createImage)\n        // }\n        return Promise.resolve(node.cloneNode(false));\n    });\n}\nfunction cloneChildren(nativeNode, clonedNode, filter) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const children = toArray(nativeNode.childNodes);\n        if (children.length === 0) {\n            return Promise.resolve(clonedNode);\n        }\n        return children\n            .reduce((done, child) => done\n            .then(() => cloneNode(child, filter))\n            .then((clonedChild) => {\n            if (clonedChild) {\n                clonedNode.appendChild(clonedChild);\n            }\n        }), Promise.resolve())\n            .then(() => clonedNode);\n    });\n}\nfunction decorate(nativeNode, clonedNode) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!(clonedNode instanceof Element)) {\n            return clonedNode;\n        }\n        return Promise.resolve()\n            .then(() => cloneCssStyle(nativeNode, clonedNode))\n            .then(() => clonePseudoElements(nativeNode, clonedNode))\n            .then(() => cloneInputValue(nativeNode, clonedNode))\n            .then(() => clonedNode);\n    });\n}\nfunction cloneCssStyle(nativeNode, clonedNode) {\n    const source = window.getComputedStyle(nativeNode);\n    const target = clonedNode.style;\n    if (source.cssText) {\n        target.cssText = source.cssText;\n    }\n    else {\n        toArray(source).forEach((name) => {\n            target.setProperty(name, source.getPropertyValue(name), source.getPropertyPriority(name));\n        });\n    }\n}\nfunction cloneInputValue(nativeNode, clonedNode) {\n    if (nativeNode instanceof HTMLTextAreaElement) {\n        clonedNode.innerHTML = nativeNode.value;\n    }\n    if (nativeNode instanceof HTMLInputElement) {\n        clonedNode.setAttribute('value', nativeNode.value);\n    }\n}\nexport function cloneNode(nativeNode, filter, isRoot) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!isRoot && filter && !filter(nativeNode)) {\n            return Promise.resolve(null);\n        }\n        return Promise.resolve(nativeNode)\n            .then(cloneSingleNode)\n            .then((clonedNode) => cloneChildren(nativeNode, clonedNode, filter))\n            .then((clonedNode) => decorate(nativeNode, clonedNode));\n    });\n}\n//# sourceMappingURL=cloneNode.js.map","/* tslint:disable:max-line-length */\nimport { getDataURLContent } from './util';\n// KNOWN ISSUE\n// -----------\n// Can not handle redirect-url, such as when access 'http://something.com/avatar.png'\n// will redirect to 'http://something.com/65fc2ffcc8aea7ba65a1d1feda173540'\nconst TIMEOUT = 30000;\nconst cache = {};\nfunction isFont(filename) {\n    return /ttf|otf|eot|woff2?/i.test(filename);\n}\nexport function getBlobFromURL(url, options) {\n    let href = url.replace(/\\?.*/, '');\n    if (isFont(href)) {\n        href = href.replace(/.*\\//, '');\n    }\n    if (cache[href]) {\n        return cache[href];\n    }\n    // cache bypass so we dont have CORS issues with cached images\n    // ref: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    if (options.cacheBust) {\n        // tslint:disable-next-line\n        url += (/\\?/.test(url) ? '&' : '?') + new Date().getTime();\n    }\n    const failed = (reason) => {\n        let placeholder = '';\n        if (options.imagePlaceholder) {\n            const parts = options.imagePlaceholder.split(/,/);\n            if (parts && parts[1]) {\n                placeholder = parts[1];\n            }\n        }\n        let msg = `Failed to fetch resource: ${url}`;\n        if (reason) {\n            msg = typeof reason === 'string' ? reason : reason.message;\n        }\n        if (msg) {\n            console.error(msg);\n        }\n        return placeholder;\n    };\n    const deferred = window.fetch\n        ? window\n            .fetch(url)\n            .then((response) => response.blob())\n            .then((blob) => new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            reader.onloadend = () => resolve(reader.result);\n            reader.onerror = reject;\n            reader.readAsDataURL(blob);\n        }))\n            .then(getDataURLContent)\n            .catch(() => new Promise((resolve, reject) => reject()))\n        : new Promise((resolve, reject) => {\n            const req = new XMLHttpRequest();\n            const timeout = () => {\n                reject(new Error(`Timeout of ${TIMEOUT}ms occured while fetching resource: ${url}`));\n            };\n            const done = () => {\n                if (req.readyState !== 4) {\n                    return;\n                }\n                if (req.status !== 200) {\n                    reject(new Error(`Failed to fetch resource: ${url}, status: ${req.status}`));\n                    return;\n                }\n                const encoder = new FileReader();\n                encoder.onloadend = () => {\n                    resolve(getDataURLContent(encoder.result));\n                };\n                encoder.readAsDataURL(req.response);\n            };\n            req.onreadystatechange = done;\n            req.ontimeout = timeout;\n            req.responseType = 'blob';\n            req.timeout = TIMEOUT;\n            req.open('GET', url, true);\n            req.send();\n        });\n    const promise = deferred.catch(failed);\n    cache[href] = promise;\n    return promise;\n}\n//# sourceMappingURL=getBlobFromURL.js.map","import { getBlobFromURL } from './getBlobFromURL';\nimport { isDataUrl, toDataURL, getMimeType } from './util';\nconst URL_REGEX = /url\\((['\"]?)([^'\"]+?)\\1\\)/g;\nexport function shouldEmbed(string) {\n    return string.search(URL_REGEX) !== -1;\n}\nexport function embedResources(cssString, baseUrl, options) {\n    if (!shouldEmbed(cssString)) {\n        return Promise.resolve(cssString);\n    }\n    return Promise.resolve(cssString)\n        .then(parseURLs)\n        .then((urls) => urls.reduce((done, url) => done.then((ret) => embed(ret, url, baseUrl, options)), Promise.resolve(cssString)));\n}\nexport function parseURLs(str) {\n    const result = [];\n    str.replace(URL_REGEX, (raw, quotation, url) => {\n        result.push(url);\n        return raw;\n    });\n    return result.filter((url) => !isDataUrl(url));\n}\nexport function embed(cssString, resourceURL, baseURL, options, get) {\n    const resolvedURL = baseURL ? resolveUrl(resourceURL, baseURL) : resourceURL;\n    return Promise.resolve(resolvedURL)\n        .then((url) => (get ? get(url) : getBlobFromURL(url, options)))\n        .then((data) => toDataURL(data, getMimeType(resourceURL)))\n        .then((dataURL) => cssString.replace(urlToRegex(resourceURL), `$1${dataURL}$3`))\n        .then((content) => content, () => resolvedURL);\n}\nfunction resolveUrl(url, baseUrl) {\n    // url is absolute already\n    if (url.match(/^[a-z]+:\\/\\//i)) {\n        return url;\n    }\n    // url is absolute already, without protocol\n    if (url.match(/^\\/\\//)) {\n        return window.location.protocol + url;\n    }\n    // dataURI, mailto:, tel:, etc.\n    if (url.match(/^[a-z]+:/i)) {\n        return url;\n    }\n    const doc = document.implementation.createHTMLDocument();\n    const base = doc.createElement('base');\n    const a = doc.createElement('a');\n    doc.head.appendChild(base);\n    doc.body.appendChild(a);\n    if (baseUrl) {\n        base.href = baseUrl;\n    }\n    a.href = url;\n    return a.href;\n}\nfunction urlToRegex(url) {\n    return new RegExp(`(url\\\\(['\"]?)(${escape(url)})(['\"]?\\\\))`, 'g');\n}\nfunction escape(url) {\n    return url.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n}\n//# sourceMappingURL=embedResources.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { getBlobFromURL } from './getBlobFromURL';\nimport { embedResources } from './embedResources';\nimport { toArray, isDataUrl, toDataURL, getMimeType } from './util';\nexport function embedImages(clonedNode, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!(clonedNode instanceof Element)) {\n            return Promise.resolve(clonedNode);\n        }\n        return Promise.resolve(clonedNode)\n            .then((node) => embedBackground(node, options))\n            .then((node) => embedImageNode(node, options))\n            .then((node) => embedChildren(node, options));\n    });\n}\nfunction embedBackground(clonedNode, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const background = clonedNode.style.getPropertyValue('background');\n        if (!background) {\n            return Promise.resolve(clonedNode);\n        }\n        return Promise.resolve(background)\n            .then((cssString) => embedResources(cssString, null, options))\n            .then((cssString) => {\n            clonedNode.style.setProperty('background', cssString, clonedNode.style.getPropertyPriority('background'));\n            return clonedNode;\n        });\n    });\n}\nfunction embedImageNode(clonedNode, options) {\n    if (!(clonedNode instanceof HTMLImageElement) || isDataUrl(clonedNode.src)) {\n        return Promise.resolve(clonedNode);\n    }\n    return Promise.resolve(clonedNode.src)\n        .then((url) => getBlobFromURL(url, options))\n        .then((data) => toDataURL(data, getMimeType(clonedNode.src)))\n        .then((dataURL) => new Promise((resolve, reject) => {\n        clonedNode.onload = resolve;\n        clonedNode.onerror = reject;\n        clonedNode.src = dataURL;\n    }))\n        .then(() => clonedNode, () => clonedNode);\n}\nfunction embedChildren(clonedNode, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const children = toArray(clonedNode.childNodes);\n        const deferreds = children.map((child) => embedImages(child, options));\n        return Promise.all(deferreds).then(() => clonedNode);\n    });\n}\n//# sourceMappingURL=embedImages.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { toArray } from './util';\nimport { shouldEmbed, embedResources } from './embedResources';\nconst cssFetchPromiseStore = {};\nexport function parseWebFontRules(clonedNode) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return new Promise((resolve, reject) => {\n            if (!clonedNode.ownerDocument) {\n                reject(new Error('Provided element is not within a Document'));\n            }\n            resolve(toArray(clonedNode.ownerDocument.styleSheets));\n        })\n            .then(getCssRules)\n            .then(getWebFontRules);\n    });\n}\nexport function embedWebFonts(clonedNode, options) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return parseWebFontRules(clonedNode)\n            .then((rules) => Promise.all(rules.map((rule) => {\n            const baseUrl = rule.parentStyleSheet\n                ? rule.parentStyleSheet.href\n                : null;\n            return embedResources(rule.cssText, baseUrl, options);\n        })))\n            .then((cssStrings) => cssStrings.join('\\n'))\n            .then((cssString) => {\n            const styleNode = document.createElement('style');\n            const sytleContent = document.createTextNode(cssString);\n            styleNode.appendChild(sytleContent);\n            if (clonedNode.firstChild) {\n                clonedNode.insertBefore(styleNode, clonedNode.firstChild);\n            }\n            else {\n                clonedNode.appendChild(styleNode);\n            }\n            return clonedNode;\n        });\n    });\n}\nexport function getCssRules(styleSheets) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const ret = [];\n        const promises = [];\n        // First loop inlines imports\n        styleSheets.forEach((sheet) => {\n            if ('cssRules' in sheet) {\n                try {\n                    toArray(sheet.cssRules).forEach((item) => {\n                        if (item.type === CSSRule.IMPORT_RULE) {\n                            promises.push(fetchCSS(item.href, sheet)\n                                .then(embedFonts)\n                                .then((cssText) => {\n                                const parsed = parseCSS(cssText);\n                                parsed.forEach((rule) => {\n                                    sheet.insertRule(rule, sheet.cssRules.length);\n                                });\n                            })\n                                .catch((e) => {\n                                console.log('Error loading remote css', e.toString());\n                            }));\n                        }\n                    });\n                }\n                catch (e) {\n                    const inline = styleSheets.find((a) => a.href === null) || document.styleSheets[0];\n                    if (sheet.href != null) {\n                        promises.push(fetchCSS(sheet.href, inline)\n                            .then(embedFonts)\n                            .then((cssText) => {\n                            const parsed = parseCSS(cssText);\n                            parsed.forEach((rule) => {\n                                inline.insertRule(rule, sheet.cssRules.length);\n                            });\n                        })\n                            .catch((e) => {\n                            console.log('Error loading remote stylesheet', e.toString());\n                        }));\n                    }\n                    console.log('Error inlining remote css file', e.toString());\n                }\n            }\n        });\n        return Promise.all(promises).then(() => {\n            // Second loop parses rules\n            styleSheets.forEach((sheet) => {\n                if ('cssRules' in sheet) {\n                    try {\n                        toArray(sheet.cssRules).forEach((item) => {\n                            ret.push(item);\n                        });\n                    }\n                    catch (e) {\n                        console.log(`Error while reading CSS rules from ${sheet.href}`, e.toString());\n                    }\n                }\n            });\n            return ret;\n        });\n    });\n}\nfunction getWebFontRules(cssRules) {\n    return cssRules\n        .filter((rule) => rule.type === CSSRule.FONT_FACE_RULE)\n        .filter((rule) => shouldEmbed(rule.style.getPropertyValue('src')));\n}\nfunction parseCSS(source) {\n    if (source === undefined) {\n        return [];\n    }\n    let cssText = source;\n    const css = [];\n    const cssKeyframeRegex = '((@.*?keyframes [\\\\s\\\\S]*?){([\\\\s\\\\S]*?}\\\\s*?)})';\n    const combinedCSSRegex = '((\\\\s*?(?:\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\/)?\\\\s*?@media[\\\\s\\\\S]' +\n        '*?){([\\\\s\\\\S]*?)}\\\\s*?})|(([\\\\s\\\\S]*?){([\\\\s\\\\S]*?)})'; // to match css & media queries together\n    const cssCommentsRegex = new RegExp('(\\\\/\\\\*[\\\\s\\\\S]*?\\\\*\\\\/)', 'gi');\n    // strip out comments\n    cssText = cssText.replace(cssCommentsRegex, '');\n    const keyframesRegex = new RegExp(cssKeyframeRegex, 'gi');\n    let arr;\n    while (true) {\n        arr = keyframesRegex.exec(cssText);\n        if (arr === null) {\n            break;\n        }\n        css.push(arr[0]);\n    }\n    cssText = cssText.replace(keyframesRegex, '');\n    // unified regex\n    const unified = new RegExp(combinedCSSRegex, 'gi');\n    while (true) {\n        arr = unified.exec(cssText);\n        if (arr === null) {\n            break;\n        }\n        css.push(arr[0]);\n    }\n    return css;\n}\nfunction fetchCSS(url, sheet) {\n    if (cssFetchPromiseStore[url]) {\n        return cssFetchPromiseStore[url];\n    }\n    const promise = fetch(url).then((res) => {\n        return {\n            url,\n            cssText: res.text(),\n        };\n    }, (e) => {\n        console.log('ERROR FETCHING CSS: ', e.toString());\n    });\n    cssFetchPromiseStore[url] = promise;\n    return promise;\n}\nfunction embedFonts(data) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return data.cssText.then((resolved) => {\n            let cssText = resolved;\n            const regexUrlFind = /url\\([\"']?([^\"')]+)[\"']?\\)/g;\n            const fontLocations = cssText.match(/url\\([^)]+\\)/g) || [];\n            const fontLoadedPromises = fontLocations.map((location) => {\n                let url = location.replace(regexUrlFind, '$1');\n                if (!url.startsWith('https://')) {\n                    const source = data.url;\n                    url = new URL(url, source).href;\n                }\n                return new Promise((resolve, reject) => {\n                    fetch(url)\n                        .then((res) => res.blob())\n                        .then((blob) => {\n                        const reader = new FileReader();\n                        reader.addEventListener('load', (res) => {\n                            // Side Effect\n                            cssText = cssText.replace(location, `url(${reader.result})`);\n                            resolve([location, reader.result]);\n                        });\n                        reader.readAsDataURL(blob);\n                    })\n                        .catch(reject);\n                });\n            });\n            return Promise.all(fontLoadedPromises).then(() => cssText);\n        });\n    });\n}\n//# sourceMappingURL=embedWebFonts.js.map","import { svgToDataURL } from './util';\nexport function createSvgDataURL(clonedNode, width, height) {\n    const xmlns = 'http://www.w3.org/2000/svg';\n    const svg = document.createElementNS(xmlns, 'svg');\n    const foreignObject = document.createElementNS(xmlns, 'foreignObject');\n    svg.setAttributeNS('', 'width', `${width}`);\n    svg.setAttributeNS('', 'height', `${height}`);\n    foreignObject.setAttributeNS('', 'width', '100%');\n    foreignObject.setAttributeNS('', 'height', '100%');\n    foreignObject.setAttributeNS('', 'x', '0');\n    foreignObject.setAttributeNS('', 'y', '0');\n    foreignObject.setAttributeNS('', 'externalResourcesRequired', 'true');\n    svg.appendChild(foreignObject);\n    foreignObject.appendChild(clonedNode);\n    return svgToDataURL(svg);\n}\n//# sourceMappingURL=createSvgDataURL.js.map","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { cloneNode } from './cloneNode';\nimport { embedImages } from './embedImages';\nimport { embedWebFonts } from './embedWebFonts';\nimport { createSvgDataURL } from './createSvgDataURL';\nimport { applyStyleWithOptions } from './applyStyleWithOptions';\nimport { delay, createImage, canvasToBlob, getNodeWidth, getNodeHeight, getPixelRatio, } from './util';\nfunction getImageSize(domNode, options = {}) {\n    const width = options.width || getNodeWidth(domNode);\n    const height = options.height || getNodeHeight(domNode);\n    return { width, height };\n}\nexport function toSvg(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { width, height } = getImageSize(domNode, options);\n        return cloneNode(domNode, options.filter, true)\n            .then((clonedNode) => embedWebFonts(clonedNode, options))\n            .then((clonedNode) => embedImages(clonedNode, options))\n            .then((clonedNode) => applyStyleWithOptions(clonedNode, options))\n            .then((clonedNode) => createSvgDataURL(clonedNode, width, height));\n    });\n}\nexport const toSvgDataURL = toSvg;\nexport function toCanvas(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return toSvg(domNode, options)\n            .then(createImage)\n            .then(delay(100))\n            .then((image) => {\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n            const ratio = options.pixelRatio || getPixelRatio();\n            const { width, height } = getImageSize(domNode, options);\n            canvas.width = width * ratio;\n            canvas.height = height * ratio;\n            canvas.style.width = `${width}`;\n            canvas.style.height = `${height}`;\n            if (options.backgroundColor) {\n                context.fillStyle = options.backgroundColor;\n                context.fillRect(0, 0, canvas.width, canvas.height);\n            }\n            context.drawImage(image, 0, 0);\n            return canvas;\n        });\n    });\n}\nexport function toPixelData(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { width, height } = getImageSize(domNode, options);\n        return toCanvas(domNode, options).then((canvas) => {\n            const ctx = canvas.getContext('2d');\n            return ctx.getImageData(0, 0, width, height).data;\n        });\n    });\n}\nexport function toPng(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return toCanvas(domNode, options).then((canvas) => canvas.toDataURL());\n    });\n}\nexport function toJpeg(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return toCanvas(domNode, options).then((canvas) => canvas.toDataURL('image/jpeg', options.quality || 1));\n    });\n}\nexport function toBlob(domNode, options = {}) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return toCanvas(domNode, options).then(canvasToBlob);\n    });\n}\n//# sourceMappingURL=index.js.map","import { toPng, toJpeg, toBlob, toPixelData, toSvg, toCanvas } from 'html-to-image';\r\nwindow.toJpeg = toJpeg;\r\nwindow.toPng = toPng;\r\nwindow.toBlob = toBlob;\r\nwindow.toPixelData = toPixelData;\r\nwindow.toSvg = toSvg;\r\nwindow.toCanvas = toCanvas;\r\n\r\nfunction loadScript(url) {\r\n    var el = document.createElement('script');\r\n    el.src = url;\r\n    document.body.appendChild(el);\r\n}\r\n\r\nfunction xhrGet(url, callback) {\r\n    var xhr = new XMLHttpRequest;\r\n    xhr.open('GET', url);\r\n    xhr.onload = function () { callback(xhr.responseText) };\r\n    xhr.send();\r\n}\r\n\r\n// if (navigator.userAgent.toLowerCase().indexOf('micromessenger') !== -1) loadScript('https://cdn.jsdelivr.net/gh/TransparentLC/WechatMomentScreenshot/fuckWechat.min.js');\r\n\r\nif (!window.Promise) loadScript('https://cdn.jsdelivr.net/npm/promise-polyfill/dist/polyfill.min.js');\r\n\r\nvar avatarURL = [];\r\nxhrGet('https://cdn.jsdelivr.net/gh/TransparentLC/WechatMomentScreenshot/avatarURL.json', function (result) { avatarURL = JSON.parse(result) });\r\nvar emoticon = [];\r\nxhrGet('https://cdn.jsdelivr.net/gh/TransparentLC/WechatMomentScreenshot/emoticon.json', function (result) { emoticon = JSON.parse(result) });\r\n\r\n// 读取配置\r\nvar configDefault = {\r\n    name: 'Cesaryuan',\r\n    text: 'Quicker真的很好用啊，大家快来用啊[微笑]',\r\n    location: '',\r\n    app: '',\r\n    height: 1920,\r\n    uiWhite: true,\r\n    appIcon: true,\r\n    statusIcon: true,\r\n};\r\nvar config;\r\nvar avatarFile;\r\ntry {\r\n    config = JSON.parse(localStorage.getItem('config')) || {};\r\n} catch (error) {\r\n    config = {};\r\n}\r\nfor (var k in configDefault) {\r\n    if (config[k] === undefined) config[k] = configDefault[k];\r\n}\r\ndocument.getElementById('configName').value = config.name;\r\ndocument.getElementById('configText').value = config.text;\r\ndocument.getElementById('configLocation').value = config.location;\r\ndocument.getElementById('configApp').value = config.app;\r\ndocument.getElementById('configHeight').value = config.height;\r\ndocument.getElementById('configUIWhite').checked = config.uiWhite;\r\ndocument.getElementById('configTopBarAppIcons').checked = config.appIcon;\r\ndocument.getElementById('configTopBarStatusIcons').checked = config.statusIcon;\r\ndocument.getElementById('avatar').style.backgroundImage = 'url(' + (localStorage.getItem('avatar') || 'https://ae01.alicdn.com/kf/HTB1yE4fMmzqK1RjSZFp761kSXXal.png') + ')';\r\n\r\n//输入微信文章的链接，通过后端自动获取文章标题和文章封面\r\nfunction getArticleInfo() {\r\n    var requestDialog = new mdui.Dialog('#request');\r\n    mdui.prompt('公众号文章链接', function (value) {\r\n        var xhr = new XMLHttpRequest;\r\n        xhr.open('GET', 'https://wmsproxy.transparentlc.workers.dev/?url=' + encodeURIComponent(value)); //获取标题和封面的服务器\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && xhr.status == 200) {\r\n                var result = JSON.parse(xhr.responseText);\r\n                document.getElementById('requestAction').innerText = 'OK';\r\n\r\n                if (requestDialog.getState() == 'opening' || requestDialog.getState() == 'opened') {\r\n                    if (typeof(result) != 'undefined' && result.success) {\r\n                        document.getElementById('configArticleTitle').value = result.title;\r\n                        document.getElementById('articleTitle').innerText = result.title;\r\n                        document.getElementById('articleIcon').style.backgroundImage = 'url(\\\"' + result.cover + '\\\")';\r\n                        document.getElementById('requestResult').innerText = '获取成功！(ゝ∀･)';\r\n                        document.getElementById('requestResultContent').innerHTML = '标题：' + result.title + '<br>封面：<a target=\"_blank\" href=\"' + result.cover + '\">点此查看</a>';\r\n                    } else {\r\n                        document.getElementById('requestResult').innerText = '获取失败！( ´_っ`)';\r\n                        document.getElementById('requestResultContent').innerHTML = '输入的链接是否为微信公众号文章？<br>（链接通常以 <code>https://mp.weixin.qq.com/</code> 作为开头）';\r\n                    }\r\n                }\r\n            } else {\r\n                document.getElementById('requestResult').innerText = '获取失败！( ´_っ`)';\r\n                document.getElementById('requestResultContent').innerHTML = '无法连接到服务器。';\r\n            }\r\n            requestDialog.handleUpdate();\r\n        }\r\n        xhr.send();\r\n        document.getElementById('requestResult').innerText = '';\r\n        document.getElementById('requestAction').innerText = 'CANCEL';\r\n        document.getElementById('requestResultContent').innerHTML = '<div class=\"mdui-valign\"><div class=\"mdui-spinner\"></div><span class=\"mdui-m-l-2\">获取中…… (oﾟωﾟo)</span></div>';\r\n        mdui.updateSpinners();\r\n        requestDialog.open();\r\n    }, function () {});\r\n}\r\n\r\n//删除所有发表的九宫格图片\r\nfunction clearMultiImage() {\r\n    for (var i = 1; i <= 9; i++) {\r\n        document.getElementById('image' + i).style.backgroundImage = '';\r\n    }\r\n}\r\n\r\n//将时间转换为微信中显示的格式\r\nfunction getTimeString(currentDate, specificDate) {\r\n    var cd = new Date(currentDate.getTime() - currentDate.getTimezoneOffset() * 60 * 1000 - (currentDate.getTime() - currentDate.getTimezoneOffset() * 60 * 1000) % (60 * 60 * 24 * 1000));\r\n    var sd = new Date(specificDate.getTime() - specificDate.getTimezoneOffset() * 60 * 1000 - (specificDate.getTime() - specificDate.getTimezoneOffset() * 60 * 1000) % (60 * 60 * 24 * 1000));\r\n    if (cd.getTime() == sd.getTime()) {\r\n        return ((specificDate.getHours() < 10) ? ('0' + specificDate.getHours()) : specificDate.getHours()) + ':' + ((specificDate.getMinutes() < 10) ? ('0' + specificDate.getMinutes()) : specificDate.getMinutes());\r\n    } else if (cd.getTime() - sd.getTime() == 60 * 60 * 24 * 1000) {\r\n        return '昨天 ' + ((specificDate.getHours() < 10) ? ('0' + specificDate.getHours()) : specificDate.getHours()) + ':' + ((specificDate.getMinutes() < 10) ? ('0' + specificDate.getMinutes()) : specificDate.getMinutes());\r\n    } else {\r\n        return specificDate.getFullYear() + '年' + (specificDate.getMonth() + 1) + '月' + specificDate.getDate() + '日 ' + ((specificDate.getHours() < 10) ? ('0' + specificDate.getHours()) : specificDate.getHours()) + ':' + ((specificDate.getMinutes() < 10) ? ('0' + specificDate.getMinutes()) : specificDate.getMinutes());\r\n    }\r\n}\r\n\r\n//复制短链接\r\nfunction copyGitLink() {\r\n    document.getElementById('gitLink').style.display = 'block';\r\n    var range = document.createRange();\r\n    range.selectNodeContents(document.getElementById('gitLink'));\r\n    var selection = document.getSelection();\r\n    selection.removeAllRanges();\r\n    selection.addRange(range);\r\n    document.execCommand('Copy');\r\n    selection.removeAllRanges();\r\n    mdui.snackbar({\r\n        message: '已复制到剪贴板～( っ*\\'ω\\'*c)'\r\n    });\r\n    document.getElementById('gitLink').style.display = 'none';\r\n}\r\n\r\nvar commentList = [];\r\n\r\n//添加评论\r\nfunction addComment(avatar, name, content, date) {\r\n    commentList.push({\r\n        'avatar': avatar,\r\n        'name': name,\r\n        'content': content,\r\n        'date': date\r\n    });\r\n\r\n    var tr = document.createElement('tr');\r\n    tr.innerHTML = '<th>' + commentList.length + '</th><th>' + name + '</th><th>' + content + '</th><th>' + date.toLocaleString() + '</th>';\r\n    document.getElementById('configCommentList').append(tr);\r\n}\r\n\r\n//删除（最后一条）评论\r\nfunction removeComment() {\r\n    if (commentList.length) {\r\n        commentList.pop();\r\n        document.getElementById('configCommentList').removeChild(document.getElementById('configCommentList').lastChild);\r\n    }\r\n}\r\n\r\n//替换表情文字和换行符为对应的HTML标签\r\nfunction emoticonReplace(text) {\r\n    text = text.replace(/\\r\\n/g, '<br>').replace(/\\n/g, '<br>');\r\n    for (var i = 0; i < emoticon.length; i++) {\r\n        text = text.replace(new RegExp(emoticon[i].name, 'g'), '<img class=\"emoticon\" src=\"' + emoticon[i].URL + '\">');\r\n    }\r\n    return text;\r\n}\r\n\r\n//设置界面显示\r\ndocument.getElementById('configTypeText').onclick = function () {\r\n    document.getElementById('configWebsite').style.display = 'none';\r\n    document.getElementById('configSingleImage').style.display = 'none';\r\n    document.getElementById('configMultiImage').style.display = 'none';\r\n    document.getElementById('article').style.display = 'none';\r\n    document.getElementById('singleImage').style.display = 'none';\r\n    document.getElementById('multiImage').style.display = 'none';\r\n}\r\ndocument.getElementById('configTypeWebsite').onclick = function () {\r\n    document.getElementById('configWebsite').style.display = 'block';\r\n    document.getElementById('configSingleImage').style.display = 'none';\r\n    document.getElementById('configMultiImage').style.display = 'none';\r\n    document.getElementById('article').style.display = 'flex';\r\n    document.getElementById('singleImage').style.display = 'none';\r\n    document.getElementById('multiImage').style.display = 'none';\r\n}\r\ndocument.getElementById('configTypeSingleImage').onclick = function () {\r\n    document.getElementById('configWebsite').style.display = 'none';\r\n    document.getElementById('configSingleImage').style.display = 'block';\r\n    document.getElementById('configMultiImage').style.display = 'none';\r\n    document.getElementById('article').style.display = 'none';\r\n    document.getElementById('singleImage').style.display = 'block';\r\n    document.getElementById('multiImage').style.display = 'none';\r\n}\r\ndocument.getElementById('configTypeMultiImage').onclick = function () {\r\n    document.getElementById('configWebsite').style.display = 'none';\r\n    document.getElementById('configSingleImage').style.display = 'none';\r\n    document.getElementById('configMultiImage').style.display = 'block';\r\n    document.getElementById('article').style.display = 'none';\r\n    document.getElementById('singleImage').style.display = 'none';\r\n    document.getElementById('multiImage').style.display = 'block';\r\n}\r\n\r\n//设初始值\r\nvar date = new Date();\r\ndocument.getElementById('configScreenshotDate').valueAsDate = date;\r\ndocument.getElementById('configScreenshotTimeHour').value = date.getHours();\r\ndocument.getElementById('configScreenshotTimeMinute').value = date.getMinutes();\r\ndocument.getElementById('configPostDate').valueAsDate = date;\r\ndocument.getElementById('configPostTimeHour').value = date.getHours();\r\ndocument.getElementById('configPostTimeMinute').value = date.getMinutes();\r\ndocument.getElementById('configCommentDate').valueAsDate = date;\r\ndocument.getElementById('configCommentTimeHour').value = date.getHours();\r\ndocument.getElementById('configCommentTimeMinute').value = date.getMinutes();\r\ndocument.getElementById('configLike').value = Math.floor(17 * Math.random()) + 5;\r\n\r\nsetTimeout(readyFake, 800);\r\n\r\n//检验数值是否合法\r\ndocument.getElementById('configPostTimeHour').addEventListener('input', function () {\r\n    if (document.getElementById('configPostTimeHour').value > 23) {\r\n        document.getElementById('configPostTimeHour').value = 23;\r\n    } else if (document.getElementById('configPostTimeHour').value < 0) {\r\n        document.getElementById('configPostTimeHour').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configPostTimeMinute').addEventListener('input', function () {\r\n    if (document.getElementById('configPostTimeMinute').value > 59) {\r\n        document.getElementById('configPostTimeMinute').value = 59;\r\n    } else if (document.getElementById('configPostTimeMinute').value < 0) {\r\n        document.getElementById('configPostTimeMinute').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configScreenshotTimeHour').addEventListener('input', function () {\r\n    if (document.getElementById('configScreenshotTimeHour').value > 23) {\r\n        document.getElementById('configScreenshotTimeHour').value = 23;\r\n    } else if (document.getElementById('configScreenshotTimeHour').value < 0) {\r\n        document.getElementById('configScreenshotTimeHour').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configScreenshotTimeMinute').addEventListener('input', function () {\r\n    if (document.getElementById('configScreenshotTimeMinute').value > 59) {\r\n        document.getElementById('configScreenshotTimeMinute').value = 59;\r\n    } else if (document.getElementById('configScreenshotTimeMinute').value < 0) {\r\n        document.getElementById('configScreenshotTimeMinute').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configCommentTimeHour').addEventListener('input', function () {\r\n    if (document.getElementById('configCommentTimeHour').value > 23) {\r\n        document.getElementById('configCommentTimeHour').value = 23;\r\n    } else if (document.getElementById('configCommentTimeHour').value < 0) {\r\n        document.getElementById('configCommentTimeHour').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configCommentTimeMinute').addEventListener('input', function () {\r\n    if (document.getElementById('configCommentTimeMinute').value > 59) {\r\n        document.getElementById('configCommentTimeMinute').value = 59;\r\n    } else if (document.getElementById('configCommentTimeMinute').value < 0) {\r\n        document.getElementById('configCommentTimeMinute').value = 0;\r\n    }\r\n})\r\ndocument.getElementById('configLike').addEventListener('input', function () {\r\n    if (document.getElementById('configLike').value < 0) {\r\n        document.getElementById('configLike').value = 0;\r\n    }\r\n})\r\n\r\n//上传图片\r\ndocument.getElementById('configAvatar').addEventListener('change', function () {\r\n    avatarFile = this.files[0];\r\n    document.getElementById('avatar').style.backgroundImage = 'url(\\\"' + URL.createObjectURL(avatarFile) + '\\\")';\r\n});\r\ndocument.getElementById('configArticleIcon').addEventListener('change', function () {\r\n    document.getElementById('articleIcon').style.backgroundImage = 'url(\\\"' + URL.createObjectURL(this.files[0]) + '\\\")';\r\n});\r\ndocument.getElementById('configSetSingleImage').addEventListener('change', function () {\r\n    document.getElementById('image').src = URL.createObjectURL(this.files[0]);\r\n});\r\n\r\nfor (var i = 1; i <= 9; i++) {\r\n    !function (i) {\r\n        document.getElementById('configSetMultiImage' + i).addEventListener('change', function () {\r\n            document.getElementById('image' + i).style.backgroundImage = 'url(\\\"' + URL.createObjectURL(this.files[0]) + '\\\")';\r\n        });\r\n    }(i);\r\n}\r\n\r\nfor(var e of document.querySelectorAll(\"textarea, input\")){\r\n    e.addEventListener('input', function () {\r\n        var fakeWechatMoment = document.getElementById('fakeWechatMoment');\r\n        fakeWechatMoment.style.transform = \"scale(0.4)\"\r\n        readyFake();\r\n    });\r\n}\r\n\r\ndocument.getElementById('generate').addEventListener('click', function () {\r\n    // 是否使用7.0以上版本白色界面？\r\n    readyFake();\r\n    var fakeWechatMoment = document.getElementById('fakeWechatMoment');\r\n    fakeWechatMoment.style.transform = \"scale(1)\"\r\n    //按钮上的提示\r\n    document.getElementById('generate').setAttribute('disabled', '');\r\n    document.getElementById('generate').innerText = '生成中...';\r\n\r\n    toCanvas(fakeWechatMoment, {\r\n        pixelRatio: 1,\r\n    }).then(function (canvas) {\r\n        fakeWechatMoment.style.transform = \"scale(0.4)\";\r\n        var dURL = canvas.toDataURL();\r\n        //document.body.replaceWith(canvas);\r\n        document.getElementById('generated').src = dURL;\r\n        document.getElementById('save').setAttribute('href', dURL);\r\n        document.getElementById('save').setAttribute('download', (+new Date) + '.png');\r\n        (new mdui.Dialog(document.getElementById('generatedPopup'))).open();\r\n\r\n        // 保存配置\r\n        var config = {\r\n            name: document.getElementById('configName').value,\r\n            text: document.getElementById('configText').value,\r\n            location: document.getElementById('configLocation').value,\r\n            app: document.getElementById('configApp').value,\r\n            height: parseInt(document.getElementById('configHeight').value),\r\n            uiWhite: document.getElementById('configUIWhite').checked,\r\n            appIcon: document.getElementById('configTopBarAppIcons').checked,\r\n            statusIcon: document.getElementById('configTopBarStatusIcons').checked,\r\n        };\r\n        localStorage.setItem('config', JSON.stringify(config));\r\n\r\n        if (avatarFile) {\r\n            var reader = new FileReader;\r\n            reader.readAsDataURL(avatarFile);\r\n            reader.onload = function () {\r\n                localStorage.setItem('avatar', this.result);\r\n            };\r\n        }\r\n    }).catch(function (error) {\r\n        mdui.alert(''\r\n            + '<div class=\"mdui-typo\">'\r\n            +     '<p>错误信息：</p>'\r\n            +     '<pre>' + error + '</pre>'\r\n            +     '<p>你可以通过 <a href=\"https://github.com/TransparentLC/WechatMomentScreenshot/issues\" target=\"_blank\">Issue</a> 向作者反馈 BUG～</p>'\r\n            + '</div>',\r\n            '生成失败'\r\n        );\r\n    }).finally(function () {\r\n        // document.getElementById('fakeWechatMoment').style.display = 'none';\r\n\r\n        document.getElementById('generate').removeAttribute('disabled');\r\n        document.getElementById('generate').innerText = '生成';\r\n    });\r\n});\r\n\r\nfunction readyFake(){\r\n    var useWhiteUI = document.getElementById('configUIWhite').checked;\r\n    if (useWhiteUI) {\r\n        document.getElementById('fakeWechatMoment').classList.add('whiteUI');\r\n        document.querySelector('#header > img').src = 'mdicons/black_icons/back.svg';\r\n        document.querySelector('.content > img').src = 'mdicons/black_icons/comment.svg';\r\n        document.querySelector('#footer > img').src = 'mdicons/black_icons/emoticon.svg';\r\n    } else {\r\n        document.getElementById('fakeWechatMoment').classList.remove('whiteUI');\r\n        document.querySelector('#header > img').src = 'mdicons/white_icons/back.svg';\r\n        document.querySelector('.content > img').src = 'mdicons/white_icons/comment.svg';\r\n        document.querySelector('#footer > img').src = 'mdicons/white_icons/emoticon.svg';\r\n    }\r\n\r\n    //设置生成的图片上的各种属性\r\n    document.getElementById('name').innerText = document.getElementById('configName').value;\r\n    document.getElementById('text').innerText = document.getElementById('configText').value;\r\n    document.getElementById('articleTitle').innerText = document.getElementById('configArticleTitle').value;\r\n    if (document.getElementById('configLocation').value == '') {\r\n        document.getElementById('location').style.display = 'none';\r\n    } else {\r\n        document.getElementById('location').style.display = 'inline';\r\n        document.getElementById('location').innerText = document.getElementById('configLocation').value;\r\n    }\r\n\r\n    //表情替换\r\n    document.getElementById('text').innerHTML = emoticonReplace(document.getElementById('text').innerText);\r\n\r\n    //九宫格模式设定\r\n    if (document.getElementById('configTypeMultiImage').checked) {\r\n        for (var i = 1; i <= 9; i++) {\r\n            document.getElementById('image' + i).style.display = 'inline-block';\r\n        }\r\n        var multiImageCount = 0;\r\n        for (multiImageCount = 9; multiImageCount >= 1; multiImageCount--) {\r\n            if (document.getElementById('image' + multiImageCount).style.backgroundImage != '') {\r\n                break;\r\n            }\r\n        }\r\n        //四张图的修正\r\n        if (multiImageCount == 4) {\r\n            document.getElementById('image5').style.backgroundImage = document.getElementById('image4').style.backgroundImage;\r\n            document.getElementById('image4').style.backgroundImage = document.getElementById('image3').style.backgroundImage;\r\n            document.getElementById('image3').style.backgroundImage = '';\r\n            multiImageCount = 5;\r\n        }\r\n        for (var i = multiImageCount + 1; i <= 9; i++) {\r\n            document.getElementById('image' + i).style.display = 'none';\r\n        }\r\n    }\r\n\r\n    //设置顶栏图标\r\n    var iconWifi = [4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 0];\r\n    var iconSignal = [4, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 0];\r\n    var iconBattery = [20, 30, 50, 60, 80, 90, 'full'];\r\n    if (document.getElementById('configTopBarStatusIcons').checked) {\r\n        document.getElementById('topBarIconWifi').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_signal_wifi_' + iconWifi[Math.floor(Math.random() * iconWifi.length)] + '_bar_48px.svg';\r\n        document.getElementById('topBarIconSignal').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_signal_cellular_' + iconWifi[Math.floor(Math.random() * iconSignal.length)] + '_bar_48px.svg';\r\n        document.getElementById('topBarIconBattery').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_battery_' + ((Math.random() > 0.75) ? 'charging_' : '') + iconBattery[Math.floor(Math.random() * iconBattery.length)] + '_48px.svg';\r\n    } else {\r\n        document.getElementById('topBarIconWifi').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_signal_wifi_4_bar_48px.svg';\r\n        document.getElementById('topBarIconSignal').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_signal_cellular_4_bar_48px.svg';\r\n        document.getElementById('topBarIconBattery').src = 'mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/ic_battery_full_48px.svg';\r\n    }\r\n    var iconApp = [['qq', .5], ['wechat', .5], ['cloudmusic', .25], ['coolapk', .15], ['tieba', .15], ['acfun', .15]];\r\n    iconApp.sort(function () { return (Math.random() > .5) ? 1 : -1 });\r\n    document.getElementById('topBarAppIcons').innerHTML = '';\r\n    if (document.getElementById('configTopBarAppIcons').checked) {\r\n        for (var i = 0; i < iconApp.length; i++) {\r\n            if (Math.random() < iconApp[i][1]) {\r\n                document.getElementById('topBarAppIcons').innerHTML += '<img class=\"topBarIcon\" src=\"mdicons/' + (useWhiteUI ? 'black_icons' : 'white_icons') + '/app_' + iconApp[i][0] +'.svg\">';\r\n            }\r\n        }\r\n    }\r\n\r\n    //设置时间\r\n    var configPostDate = document.getElementById('configPostDate').valueAsDate;\r\n    configPostDate.setHours(document.getElementById('configPostTimeHour').value);\r\n    configPostDate.setMinutes(document.getElementById('configPostTimeMinute').value);\r\n    var configScreenshotDate = document.getElementById('configScreenshotDate').valueAsDate;\r\n    configScreenshotDate.setHours(document.getElementById('configScreenshotTimeHour').value);\r\n    configScreenshotDate.setMinutes(document.getElementById('configScreenshotTimeMinute').value);\r\n\r\n    document.getElementById('time').innerText = getTimeString(configScreenshotDate, configPostDate);\r\n    document.getElementById('topBarTime').innerText = ((document.getElementById('configScreenshotTimeHour').value < 10) ? ('0' + document.getElementById('configScreenshotTimeHour').value) : document.getElementById('configScreenshotTimeHour').value) + ':' + ((document.getElementById('configScreenshotTimeMinute').value < 10) ? ('0' + document.getElementById('configScreenshotTimeMinute').value) : document.getElementById('configScreenshotTimeMinute').value);\r\n\r\n    if (document.getElementById('configApp') != '') {\r\n        document.getElementById('time').innerText += ' ' + document.getElementById('configApp').value;\r\n    }\r\n\r\n    //加入点赞头像\r\n    var avatar = document.getElementsByClassName('likeAvatar');\r\n    var avatarSource = avatarURL.concat();\r\n    var avatarUsedIndex = 0;\r\n    document.getElementById('likeAvatarList').innerHTML = '';\r\n    for (var i = 0; i < document.getElementById('configLike').value; i++) {\r\n        if (avatarSource.length <= 0) {\r\n            avatarSource = avatarURL.concat();\r\n        }\r\n        avatarUsedIndex = Math.floor(Math.random() * avatarSource.length);\r\n        var div = document.createElement('div');\r\n        div.setAttribute('class', 'likeAvatar squareImage');\r\n        div.setAttribute('style', 'background-image:url(\\\"' + avatarSource[avatarUsedIndex] + '\\\")');\r\n        document.getElementById('likeAvatarList').appendChild(div);\r\n        avatarSource.splice(avatarUsedIndex, 1);\r\n    }\r\n\r\n    //加入评论区\r\n    document.getElementById('commentList').innerHTML = '';\r\n    if (document.getElementById('configShowComment').checked && commentList.length) {\r\n        document.getElementById('comment').style.display = 'block';\r\n        for (var i = 0; i < commentList.length; i++) {\r\n            document.getElementById('commentList').innerHTML += ''\r\n                + '<div class=\"commentItem\">'\r\n                +     '<div class=\"commentAvatar squareImage\" style=\"background-image: url(' + commentList[i].avatar + ');\"></div>'\r\n                +     '<div class=\"content\">'\r\n                +         '<span class=\"commentName\">' + commentList[i].name + '</span>'\r\n                +         '<span class=\"commentTime\">' + getTimeString(configScreenshotDate, commentList[i].date) + '</span>'\r\n                +         '<div class=\"commentText\">' + emoticonReplace(commentList[i].content) + '</div>'\r\n                +     '</div>'\r\n                + '</div>';\r\n        }\r\n    } else {\r\n        document.getElementById('comment').style.display = 'none';\r\n    }\r\n\r\n    //显示用于生成图片的div\r\n    var height = Number(document.getElementById('configHeight').value);\r\n    document.getElementById('fakeWechatMoment').style.display = 'block';\r\n    document.getElementById('fakeWechatMoment').style.width = '1080px';\r\n    document.getElementById('fakeWechatMoment').style.height = '';\r\n    document.getElementById('fakeWechatMoment').style.height = ((window.getComputedStyle(document.getElementById('fakeWechatMoment')).height.replace('px', '') > height) ? window.getComputedStyle(document.getElementById('fakeWechatMoment')).height.replace('px', '') : height) + 'px';\r\n\r\n    //点赞数为0时隐藏点赞区\r\n    if (document.getElementById('configLike').value <= 0) {\r\n        document.getElementById('triangle').style.display = 'none';\r\n        document.getElementById('like').style.display = 'none';\r\n    } else {\r\n        document.getElementById('triangle').style.display = 'block';\r\n        document.getElementById('like').style.display = 'block';\r\n    }\r\n\r\n    //修正底部位置\r\n    var offset = Number(window.getComputedStyle(document.getElementById('topBar')).height.replace('px', '')) + Number(window.getComputedStyle(document.getElementById('header')).height.replace('px', '')) + Number(window.getComputedStyle(document.getElementById('main')).height.replace('px', ''));\r\n    document.getElementById('footer').style.bottom = ((offset < height - Number(window.getComputedStyle(document.getElementById('footer')).height.replace('px', ''))) ? (-height + Number(window.getComputedStyle(document.getElementById('footer')).height.replace('px', '')) + offset) : 0) + 'px';\r\n\r\n\r\n}\r\n\r\n","export function applyStyleWithOptions(clonedNode, options) {\n    const { style } = clonedNode;\n    if (options.backgroundColor) {\n        style.backgroundColor = options.backgroundColor;\n    }\n    if (options.width) {\n        style.width = `${options.width}px`;\n    }\n    if (options.height) {\n        style.height = `${options.height}px`;\n    }\n    const manual = options.style;\n    if (manual != null) {\n        Object.keys(manual).forEach((key) => {\n            // @ts-expect-error\n            style[key] = manual[key];\n        });\n    }\n    return clonedNode;\n}\n//# sourceMappingURL=applyStyleWithOptions.js.map"],"sourceRoot":""}